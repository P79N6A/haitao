<include file="Home:headercat"/>
<!-- Specific CSS for the example -->
<style>
  /**
   * Grid items
   */
  #tiles dl {
    opacity: 0;
    -webkit-transition: all 0.3s ease-out;
       -moz-transition: all 0.3s ease-out;
         -o-transition: all 0.3s ease-out;
            transition: all 0.3s ease-out;
  }
</style>
<!-- 商品分类 -->
<div class="header">
  <!-- <a href="#" class="logo" style="width:30%"><span class="u-icon i-radio"></span>有货商品</a>
  <a href="#" class="search_1"><span class="i-sort"></span>价格</a>
  <a href="#" class="user-icon"><span class="i-sort"></span>折扣</a> -->
  <div id="dl-menu" class="dl-menuwrapper">
    <!-- <button id="dl-menu-button"><span class="i-classify"></span>筛选</button> -->
    <div class="dl-menu">
    <ul class="list">
       <li data-cateid="0" class="active"> <a href="javascript:;">全部 <span>(226)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20447"> <a href="javascript:;">女款背心 <span>(19)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20456"> <a href="javascript:;">女款外套 <span>(20)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20464"> <a href="javascript:;">女款针织衫 <span>(12)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20468"> <a href="javascript:;">女款休闲裤 <span>(48)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20469"> <a href="javascript:;">半身裙 <span>(17)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20470"> <a href="javascript:;">连衣裙 <span>(51)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20481"> <a href="javascript:;">抹胸/吊带 <span>(7)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20574"> <a href="javascript:;">男款运动休闲裤 <span>(1)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20804"> <a href="javascript:;">女款T恤 <span>(22)</span><span class="u-select"></span></a> </li>
       <li data-cateid="20807"> <a href="javascript:;">女款衬衫 <span>(22)</span><span class="u-select"></span></a> </li>
       <li data-cateid="22943"> <a href="javascript:;">女款连体裤 <span>(7)</span><span class="u-select"></span></a> </li>
     </ul>
     <div class="c_scroller" style="transition-duration: 0ms; -webkit-transition-duration: 0ms; transform-origin: 0px 0px 0px; position: absolute; top: 0px; right: 0px;width:47%">
      <ul data-listid="0" class="" style="display:block">
        <li class="active"> <a href="#" data-query="0-0" data-which="isFilter" class="load_list_btn4">全部<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-MlhM" data-which="isFilter" class="load_list_btn4">2XL<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-M1hM" data-which="isFilter" class="load_list_btn4">3XL<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-NFhM" data-which="isFilter" class="load_list_btn4">4XL<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-NVhM" data-which="isFilter" class="load_list_btn4">5XL<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-NlhM" data-which="isFilter" class="load_list_btn4">6XL<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-TA" data-which="isFilter" class="load_list_btn4">L<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-TQ" data-which="isFilter" class="load_list_btn4">M<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-Uw" data-which="isFilter" class="load_list_btn4">S<span class="u-select"></span></a> </li>
        <li> <a href="#" data-query="0-WEw" data-which="isFilter" class="load_list_btn4">XL<span class="u-select"></span></a> </li>
      </ul>
       <div id="u-wrapper-b" class="navbar navbar-default navbar-fixed-bottom drop_bottom">
        <div class="container nav-current-box"> <a href="javascript:;" class="btn btn-purple btn-large" data-which="isFilter" data-query="">确 定</a> </div>
      </div>
    </div>
  </div>
</div>
  <div id="main" role="main" style="position: relative;">
  <div class="u-pro-list J_pro_list clearfix " data-offset="20" data-limit="20" data-img-class="j_item_image" id="tiles">
  </div>
  <div class="u-pro-list J_pro_list clearfix" id="loader" style="position: absolute;left: 43%;z-index: 999;color: #000;bottom: -30px;margin: 0;">
    <div id="loaderCircle">正在加载...</div>
  </div>
  </div>
  <div class="kuan"></div>
</div>
<script type="text/javascript">
$(function(){
  $( '#dl-menu' ).dlmenu();
});
</script>
  <!-- include jQuery -->
  <script src="../Public/libs/jquery.min.js"></script>

  <!-- Include the imagesLoaded plug-in -->
  <script src="../Public/libs/jquery.imagesloaded.js"></script>

  <!-- Include the plug-in -->
  <script src="../Public/src/js/jquery.wookmark.js"></script>

  <!-- Once the page is loaded, initalize the plug-in. -->
  <script type="text/javascript">
    (function ($) {
      var $tiles = $('#tiles'),
          $handler = $('dl', $tiles),
          page = 1,
          isLoading = false,
          apiURL = "{:U('Home/Product/shop_goods',array('ad_column'=>$_GET['ad_column']))}",
          lastRequestTimestamp = 0,
          fadeInDelay = 1000,
          $window = $(window),
          $document = $(document);

          // Prepare layout options.
          var options = {
            autoResize: true, // This will auto-update the layout when the browser window is resized.
            container: $('#tiles'), // Optional, used for some extra CSS styling
            offset: 6, // Optional, the distance between grid items
            itemWidth: "48%" // Optional, the width of a grid item
          };

      /**
       * When scrolled all the way to the bottom, add more tiles.
       */
      function onScroll(event) {
        // Only check when we're not still waiting for data.
        if (!isLoading) {
          // Check if we're within 100 pixels of the bottom edge of the broser window.
          var closeToBottom = ($window.scrollTop() + $window.height() > $document.height() - 100);
          if (closeToBottom) {
            // Only allow requests every second
            var currentTime = new Date().getTime();
            if (lastRequestTimestamp < currentTime - 1000) {
              lastRequestTimestamp = currentTime;
              loadData();
            }
          }
        }
      };

      /**
       * Refreshes the layout.
       */
      function applyLayout($newImages) {
        options.container.imagesLoaded(function() {
          // Destroy the old handler
          if ($handler.wookmarkInstance) {
            $handler.wookmarkInstance.clear();
          }

          // Create a new layout handler.
          $tiles.append($newImages);
          $handler = $('dl', $tiles);
          $handler.wookmark(options);

          // Set opacity for each new image at a random time
          $newImages.each(function() {
            var $self = $(this);
            window.setTimeout(function() {
              $self.css('opacity', 1);
            }, Math.random() * fadeInDelay);
          });
        });
      };

      /**
       * Loads data from the API.
       */
      function loadData() {
        isLoading = true;
        $('#loaderCircle').show();

        $.ajax({
          url: apiURL,
          dataType: 'json', // Set to jsonp if you use a server on a different domain and change it's setting accordingly
          data: {page: page}, // Page parameter to make sure we load new data
          success: onLoadData
        });
      };

      /**
       * Receives data from the API, creates HTML for images and updates the layout
       */
      function onLoadData(response) {
        isLoading = false;
        $('#loaderCircle').hide();
        // Disable requests if we reached the end
        if (response.info == 'No more data') {
          $document.off('scroll', onScroll);
          return false;
        }
        // Increment page index for future calls.
        page++;

        // Create HTML for the images.
        var html = '',
            data = response.data,
            i = 0, length = data.length, image, opacity,
            $newImages;
            var class_name,cover_txt;
        for (; i < length; i++) {
          image = data[i];
          html += '<dl class="rs-item pg" data-mid="59959869">';
          html += '<a href="'+image.url+'&shop_id='+image.shop_id+'" class="clearfix ablock">';
          class_name = 'class="pic"';
          if (image.stock <= 0)
            cover_txt = '<div class="u-seldout-cover"><span class="seldout"></span></div>';
          else
            cover_txt = '';
          html += '<dt '+class_name+'> <img src="'+image.thumb+'" class="j_item_image" style="display: inline;">'+cover_txt+'</dt>';
          html += '<dd class="b_goods_name">'+image.title+'</dd>';
          html += '<dd class="pricebox clearfix"><span class="grallyprice f-left">¥'+image.member_price+'</span><span class="markprice">¥'+image.price+'</span></dd></a></dl>';
        }

        $newImages = $(html);

        // Apply layout.
        applyLayout($newImages);
      };

      // Capture scroll event.
      $document.on('scroll', onScroll);

      // Load first data from the API.
      loadData();
    })(jQuery);
  </script>
<include file="Home:footer"/>